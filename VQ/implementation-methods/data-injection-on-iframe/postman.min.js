!function(){function t(t){t=t||{},this.id=t.id||i(),this.type=t.type,this.name=t.name,this.error=t.error,this.payload=t.payload}function e(t,e,n){this.id=i(),this.contentWindow=t,this.domain=e,this.handlers={},this.timeoutDuration=n,this.timeoutDuration||0===this.timeoutDuration||(this.timeoutDuration=1e4),this.callbacks={},this.timeoutHandlers={},a[this.id]=this}function i(t){var e="23456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghkmnpqrstuvwxyz",i="";t=t||6;for(var n=0;n<t;n++){var a=Math.floor(Math.random()*e.length);i+=e.substring(a,a+1)}return i}var n={},a={};n.createClient=function(t,i,n){return new e(t,i,n)},n.getClientByWindow=function(t){var e;for(var i in a)a[i].contentWindow==t&&(e=a[i]);return e},t.create=function(e){return new t(e||{})},t.parse=function(e){var i=JSON.parse(e.data);return new t(i)},t.prototype.toJSON=function(){var t={id:this.id,type:this.type,name:this.name,error:this.error,payload:this.payload};return JSON.stringify(t)},e.prototype.sendMessage=function(t){this.contentWindow.postMessage(t.toJSON(),this.domain)},e.prototype.emit=function(e,i,n,a){var r=this,o=t.create({type:"req",name:e,payload:i});if(n){this.callbacks[o.id]=n;var s=isNaN(Number(a))?this.timeoutDuration:Number(a);s>0&&(this.timeoutHandlers[o.id]=setTimeout(function(){var t=r.callbacks[o.id];t&&t(new Error("Timeout exceed.")),delete r.callbacks[o.id],delete r.timeoutHandlers[o.id]},s))}this.sendMessage(o)},e.prototype.on=function(t,e){this.handlers[t]=e},e.prototype.handleRequest=function(e){var i=this,n=this.handlers[e.name];if(n){var a=function(n,a){var r=t.create({id:e.id,name:e.name,type:"res",error:n,payload:a});i.sendMessage(r)};n&&n(e.payload,a)}},e.prototype.handleResponse=function(t){var e=this.callbacks[t.id];e&&e(t.error,t.payload),this.timeoutHandlers[t.id]&&clearTimeout(this.timeoutHandlers[t.id]),delete this.callbacks[t.id]},e.prototype.destroy=function(){for(var t in this.timeoutHandlers)clearTimeout(this.timeoutHandlers[t]);for(var t in this.callbacks)this.callbacks[t](new Error("Postman client has destoyed."));delete a[this.id]},window.addEventListener("message",function(e){try{var i=t.parse(e),a=n.getClientByWindow(e.source);if(!a)return;switch(i.type){case"req":a.handleRequest(i);break;case"res":a.handleResponse(i)}}catch(r){}},!1),"undefined"!=typeof module&&(module.exports=n),"undefined"!=typeof window&&(window.postman=n)}();